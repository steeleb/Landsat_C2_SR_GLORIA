---
title: "Comparison of GLORIA data and SR pulls"
author: "ROSSyndicate"
date: "2024-08-06"
params:
  matches: d_matches_light
  matches_nomask: d_matches_light_no_mask
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(targets)

tar_load(e_matches_light)
tar_load(maciel_matches)
```

# Sanity check

Look at days difference frequency

```{r}
ggplot(e_matches_light, aes(x = day_diff)) + 
  geom_histogram() +
  theme_bw()
```

Also look at mission frequecny

```{r}
ggplot(e_matches_light, aes(x = mission)) + 
  geom_histogram(stat = "count") +
  theme_bw()
```

Double checked the data for issues on my end, but it really just looks like 
matchups with multiple satellites and we just chose differently. Any time there is
a day-difference difference we also mis-match sensors. 

# Comparing our satellite pulls to theirs


```{r}
maciel_matches <- maciel_matches %>% 
  rename_with(~ paste0(., "_maciel"),
              .cols = contains("satellite")) %>% 
  rename_with(~ paste0(., "_maciel"),
              .cols = contains("insitu")) 
matched_data <- inner_join(e_matches_light, maciel_matches)
```

```{r}
ggplot(matched_data, aes(x = med_Aerosol/3.14, y = CA_satellite_maciel)) +
  geom_point() +
  theme_bw()

ggplot(matched_data, aes(x = med_Blue/3.14, y = Blue_satellite_maciel)) +
  geom_point() +
  theme_bw()

ggplot(matched_data, aes(x = med_Green/3.14, y = Green_satellite_maciel)) +
  geom_point() +
  theme_bw()

ggplot(matched_data, aes(x = med_Red/3.14, y = Red_satellite_maciel)) +
  geom_point() +
  theme_bw()

ggplot(matched_data, aes(x = med_Nir/3.14, y = NIR_satellite_maciel)) +
  geom_point() +
  theme_bw()

```


```{r}
ggplot(matched_data, aes(x = CA_insitu, y = med_Aerosol/3.14)) + 
  geom_point() +
  geom_point(aes(x = CA_insitu_maciel, y = CA_satellite_maciel), color = "blue") +
  labs(x = "in situ",
       y = "median pull",
       title = "Aerosol") +
  theme_bw()
ggplot(matched_data, aes(x = Red_insitu, y = med_Red/3.14)) + 
  geom_point() +
  geom_point(aes(x = Red_insitu_maciel, y = Red_satellite_maciel), color = "blue") +
  labs(x = "our Rrs",
       y = "their Rrs",
       title = "Red") +
  theme_bw()
ggplot(matched_data, aes(x = Blue_insitu, y = med_Blue/3.14)) + 
  geom_point() +
  geom_point(aes(x = Blue_insitu_maciel, y = Blue_satellite_maciel), color = "blue") +
  labs(x = "our Rrs",
       y = "their Rrs",
       title = "Blue") +
  theme_bw()
ggplot(e_matches_light, aes(x = Green_insitu, y = med_Green/3.14)) + 
  geom_point() +
  geom_point(data = maciel_matches, aes(x = Green_insitu_maciel, y = Green_satellite_maciel), color = "blue") +
  labs(x = "our Rrs",
       y = "their Rrs",
       title = "Blue") +
  theme_bw()
ggplot(e_matches_light, aes(x = NIR_insitu, y = med_Nir)) + 
  geom_point() +
  geom_point(data = maciel_matches, aes(x = NIR_insitu, y = NIR_satellite), color = "blue") +
  labs(x = "our Rrs",
       y = "their Rrs",
       title = "Nir") +
  theme_bw()
```

# Comparing sat data to insitu

And then just comparing the values to insitu. Our data is in black, theirs in blue.

```{r}
ggplot(d_matches_light, aes(x = CA_insitu, y = med_Aerosol/3.14)) + 
  geom_point() +
  geom_point(aes(y = CA_satellite), color = 'blue') +
  theme_bw()
ggplot(d_matches_light, aes(y = med_Red/3.14, x = Red_insitu))  + 
  geom_point() +
  geom_point(aes(y = Red_satellite), color = 'blue') +
  theme_bw()
ggplot(d_matches_light, aes(y = med_Green/3.14, x = Green_insitu))  + 
  geom_point() +
  geom_point(aes(y = Green_satellite), color = 'blue') +
  theme_bw()
ggplot(d_matches_light, aes(y = med_Blue/3.14, x = Blue_insitu))  + 
  geom_point() +
  geom_point(aes(y = Blue_satellite), color = 'blue') +
  theme_bw()
ggplot(d_matches_light, aes(y = med_Nir/3.14, x = NIR_insitu))  + 
  geom_point() +
  geom_point(aes(y = NIR_satellite), color = 'blue') +
  theme_bw()
```

